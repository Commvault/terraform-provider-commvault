---
page_title: " Commvault : commvault_storage_cloud_bucket_s3 Resource"
subcategory: "Storage"
description: |-
  Use the commvault_storage_cloud_bucket_s3 resource type to create or delete Amazon S3 bucket in the CommCell environment.
---

# commvault_storage_cloud_bucket_s3 (Resource)

Use the commvault_storage_cloud_bucket_s3 resource type to create or delete Amazon S3 bucket in the CommCell environment.

## Example Usage

**Configure Amazon S3 bucket with required fields**
```hcl
data "commvault_client"  "media_agent2" {
  name = "MA1"
}

data "commvault_credential" "awscred" {
  name = "Terraform-AWS"
}

resource "commvault_storage_cloud_s3"  "storage_cloud_s3-1" {
    name = "SP32-Test-Terraform-cloud-s3-Storage-AccessSecret"
    mediaagent {
        id = data.commvault_client.media_agent2.id
      }
    servicehost = "s3.ap-south-1.amazonaws.com"
    authentication = "Access and secret keys"
    credentials {
      id = data.commvault_credential.awscred.id
    }
    bucket = "terraform-test1-bucket"
    storageclass = "Standard"
}

resource "commvault_storage_cloud_bucket_s3" "commvault_storage_cloud_bucket_s3-1" {
  cloudstorageid = commvault_storage_cloud_s3.storage_cloud_s3-1.id
  bucket = "terraform-cs-test3-bucket"
  mediaagent {
    id = data.commvault_client.media_agent2.id
  }
  storageclass = "Standard"
  servicehost = "s3.ap-south-1.amazonaws.com"
  credentials {
      id = data.commvault_credential.awscred.id
    }
  authentication = "Access and secret keys"
}
```

**Configure Amazon S3 bucket with custom fields**
```hcl
data "commvault_client"  "media_agent1" {
  name = "amazon-ec2-i-0c107eccb94c550e7"
}

data "commvault_credential" "awscred" {
  name = "Sheza-Terraform-AWS"
}

data "commvault_client"  "media_agent2" {
  name = "bdcsrvtest05"
}

data "commvault_role" "role2" {
  name = "Alert Owner"
}

data "commvault_user" "user1" {
  name = "testui"
}

data "commvault_usergroup" "usergroup1" {
  name = "{Testing Issue}"
}

data "commvault_credential" "awscred" {
  name = "Sheza-Terraform-AWS"
}

resource "commvault_storage_cloud_s3"  "storage_cloud_s3-2" {
    name = "SP32-Test-Terraform-cloud-s3-Storage-AccessSecret-Custom"
    mediaagent {
        id = data.commvault_client.media_agent2.id
      }
    servicehost = "s3.ap-south-1.amazonaws.com"
    authentication = "Access and secret keys"
    credentials {
      id = data.commvault_credential.awscred.id
    }
    bucket = "terraform-test1-bucket"
    storageclass = "Standard"
    usededuplication = "true"
    deduplicationdblocation {
      path = "E:\\TerraformBackuploc"
      mediaagent {
        id = data.commvault_client.media_agent2.id
      }
    }
    security {
      role {
        id = data.commvault_role.role2.id
      }
      usergroup {
        id = data.commvault_usergroup.usergroup1.id
      }
    }
    encryption {
      cipher = "BlowFish"
      keylength = 256
      encrypt = "true"
      keyprovider {
        id = 1
        name = "Built-in"
      }
    }   
}

resource "commvault_storage_cloud_bucket_s3" "commvault_storage_cloud_bucket_s3-2" {
  cloudstorageid = commvault_storage_cloud_s3.storage_cloud_s3-2.id
  bucket = "terraform-test2-bucket"
  mediaagent {
    id = data.commvault_client.media_agent2.id
  }
  storageclass = "Standard - Infrequent access"
  servicehost = "s3.ap-south-1.amazonaws.com"
  credentials {
      id = data.commvault_credential.awscred.id
    }
  authentication = "Access and secret keys"
  password = "##########"
  port = 8080
  proxyaddress = "test.abc.com"
  username = "administrator"
  enable = "true"
  access = "READ_AND_WRITE"
  configuration {
    enable = "true"
    disablebackuplocationforfuturebackups = "true"
    prepareforretirement = "true"
    storageacceleratorcredentials {
    id = data.commvault_credential.awscred1.id
    }  
  }
}
```


<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `authentication` (String) Authentication type for the cloud storage server [Access and secret keys, AWS IAM role policy, AWS STS assume role, AWS STS assume role with IAM role policy]
- `bucket` (String) Name of bucket
- `cloudstorageid` (Number)
- `mediaagent` (Block List, Min: 1) (see [below for nested schema](#nestedblock--mediaagent))
- `servicehost` (String) IP address or fully qualified domain name or URL for the cloud library based on cloud vendor
- `storageclass` (String) Appropriate storage class for your account [Standard, Reduced Redundancy Storage, Standard - Infrequent access, One zone - Infrequent access, Intelligent tiering, S3 Glacier, Standard/Glacier (Combined Storage Tiers), Standard-IA/Glacier (Combined Storage Tiers), One Zone-IA/Glacier (Combined Storage Tiers), Intelligent-Tiering/Glacier (Combined Storage Tiers), S3 Glacier Deep Archive, Standard/Deep Archive (Combined Storage Tiers), Standard-IA/Deep Archive (Combined Storage Tiers), One Zone-IA/Deep Archive (Combined Storage Tiers), Intelligent-Tiering/Deep Archive (Combined Storage Tiers)]

### Optional

- `access` (String) The access type for the access path can be either read (writing to path not allowed) or read and write (writing to path allowed). [READ_AND_WRITE, READ]
- `arnrole` (String) Needed for AWS STS assume role and AWS STS assume role with IAM role policy
- `configuration` (Block List) (see [below for nested schema](#nestedblock--configuration))
- `credentials` (Block List) (see [below for nested schema](#nestedblock--credentials))
- `enable` (String) Enable/Disable access of bucket to a media Agent
- `password` (String) Password for proxy configuration (Should be in Base64 format)
- `port` (Number) Port for proxy configuration
- `proxyaddress` (String) If the MediaAgent accesses the mount path using a proxy then proxy server address needs to be provided. If you want to remove proxy information, pass empty string in proxyAddress.
- `username` (String) Username for proxy configuration

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--mediaagent"></a>
### Nested Schema for `mediaagent`

Optional:

- `name` (String)

Read-Only:

- `id` (Number) The ID of this resource.


<a id="nestedblock--configuration"></a>
### Nested Schema for `configuration`

Optional:

- `disablebackuplocationforfuturebackups` (String) When true, prevents new data writes to backup location by changing number of writers to zero
- `enable` (String) When true, means mount path is enabled
- `prepareforretirement` (String) When true, the deduplicated blocks in the mount path will not be referenced when there are multiple mount paths in the library.
- `storageacceleratorcredentials` (Block List) (see [below for nested schema](#nestedblock--configuration--storageacceleratorcredentials))

<a id="nestedblock--configuration--storageacceleratorcredentials"></a>
### Nested Schema for `configuration.storageacceleratorcredentials`

Optional:

- `name` (String)

Read-Only:

- `id` (Number) The ID of this resource.



<a id="nestedblock--credentials"></a>
### Nested Schema for `credentials`

Optional:

- `name` (String)

Read-Only:

- `id` (Number) The ID of this resource.


